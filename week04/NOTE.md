## 本周总结

### JavaScript | 结构化
### 事件循环

感性认识就是宿主环境执行js代码的一种机制，这个宿主可能是node也可能是浏览器，js引擎自身是没有事件循环这件事的，它是一个单线程的运行机制。

宿主环境每次执行的js代码都会形成一个宏任务队列，在每个宏任务中，js代码都可能产生异步代码，无论同步代码还是异步代码，都是由js引擎发起的微任务，这些微任务聚合在一起，组成了一个宏任务。

宏任务有优先级之分，但在同一个宏任务内的微任务，只按入队的顺序来执行，微任务没有优先级之说。

如何分析一段js代码的异步执行顺序：

+ 首先分析有多少段宏任务
+ 在每个宏任务中，分析有多少个微任务
+ 根据调用次序，确定宏任务中的微任务的执行次序
+ 根据宏任务的触发规则和调用次序，确定宏任务的执行次序
+ 确定整个代码的执行次序

如何判断哪些是宏任务哪些是微任务？感性认识，只要是由js引擎自身发起的都是微任务，其他的长得不像js引擎发起的任务就当做宏任务，在大体上可以判断出来。

具体一点来说的话，

#### 宏任务有

|| 浏览器 | Node |
|:-:|-:|-:|
| I/O | √ | √ |
| setTimeout | √ | √ |
| setInterval | √ | √ |
| setImmediate | × | √ |
| requestAnimationFrame | √ | × |

#### 微任务有

|| 浏览器 | Node |
|:-:|-:|-:|
| process.nextTick | × | √ |
| Promise | √ | √ |
| await | √ | √ |
| catch finally | √ | √ |
| MutationObserver | √ | × |

##### 感想：这节课非常有收获，从感性和实际上都很好地认识了事件循环、宏任务和微任务的概念和运行机制，对js异步执行代码的分析也有了一个新的提升。
